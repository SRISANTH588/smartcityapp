<!DOCTYPE html>
<html>
<head>
    <title>Export Data - Smart City</title>
    <style>
        body { font-family: Arial; padding: 20px; background: #1a1a2e; color: white; }
        .container { max-width: 1000px; margin: 0 auto; }
        h1 { color: #3b82f6; }
        .section { background: #16213e; padding: 20px; margin: 20px 0; border-radius: 10px; }
        textarea { width: 100%; height: 300px; padding: 10px; font-family: monospace; font-size: 12px; }
        button { background: #3b82f6; color: white; border: none; padding: 15px 30px; font-size: 16px; cursor: pointer; border-radius: 5px; margin: 10px 5px; }
        button:hover { background: #2563eb; }
        .info { background: #0f3460; padding: 15px; border-radius: 5px; margin: 10px 0; }
        .success { background: #10b981; color: white; padding: 10px; border-radius: 5px; display: none; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸŒ† Smart City Data Manager</h1>
        
        <div class="section">
            <h2>ğŸ“¤ Step 1: Export Your Local Data</h2>
            <div class="info">
                <strong>Current Data Found:</strong>
                <div id="dataInfo">Checking...</div>
            </div>
            <button onclick="exportData()" style="background: #10b981;">ğŸ“¥ Export All Data</button>
            <button onclick="copyToClipboard()" style="background: #f59e0b;">ğŸ“‹ Copy to Clipboard</button>
            <textarea id="exportArea" readonly></textarea>
        </div>
        
        <div class="section">
            <h2>ğŸ“¥ Step 2: Import Data (Use on GitHub Pages)</h2>
            <textarea id="importArea" placeholder="Paste your exported data here..."></textarea>
            <button onclick="importData()">âœ… Import Data</button>
            <div id="successMsg" class="success">âœ… Data imported successfully! Redirecting to main page...</div>
        </div>
    </div>
    
    <script>
        function checkData() {
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            const issues = JSON.parse(localStorage.getItem('issues') || '[]');
            const places = JSON.parse(localStorage.getItem('touristPlaces') || '[]');
            const buses = JSON.parse(localStorage.getItem('buses') || '[]');
            const emergency = JSON.parse(localStorage.getItem('emergencyNumbers') || '[]');
            
            document.getElementById('dataInfo').innerHTML = `
                <p>ğŸ‘¥ Users: ${users.length}</p>
                <p>ğŸ“ Issues: ${issues.length}</p>
                <p>ğŸ›ï¸ Tourist Places: ${places.length}</p>
                <p>ğŸšŒ Bus Routes: ${buses.length}</p>
                <p>ğŸ“ Emergency Numbers: ${emergency.length}</p>
            `;
        }
        
        function exportData() {
            const data = {};
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                data[key] = localStorage.getItem(key);
            }
            const jsonStr = JSON.stringify(data, null, 2);
            document.getElementById('exportArea').value = jsonStr;
            alert('âœ… Data exported! Now copy it using the "Copy to Clipboard" button.');
        }
        
        function copyToClipboard() {
            const textarea = document.getElementById('exportArea');
            if (!textarea.value) {
                alert('âŒ Please export data first!');
                return;
            }
            textarea.select();
            document.execCommand('copy');
            alert('âœ… Copied to clipboard! Now:\n1. Go to your GitHub Pages site\n2. Open this same page (export-data.html)\n3. Paste in the Import section\n4. Click Import Data');
        }
        
        function importData() {
            const data = document.getElementById('importArea').value.trim();
            if (!data) {
                alert('âŒ Please paste exported data first!');
                return;
            }
            
            try {
                const parsed = JSON.parse(data);
                let count = 0;
                
                Object.keys(parsed).forEach(key => {
                    if (parsed[key]) {
                        localStorage.setItem(key, parsed[key]);
                        count++;
                    }
                });
                
                document.getElementById('successMsg').style.display = 'block';
                
                setTimeout(() => {
                    window.location.href = 'index.html';
                }, 2000);
                
            } catch (e) {
                alert('âŒ Invalid data format! Please copy the exact exported data.');
                console.error(e);
            }
        }
        
        checkData();
    </script>
</body>
</html>
